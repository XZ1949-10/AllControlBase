# controller_params.yaml
# 控制器 ROS 节点基础配置 (ROS1 Noetic)
#
# =============================================================================
# 配置架构说明
# =============================================================================
#
# 配置优先级 (从低到高):
#   1. universal_controller/config/*.py  - 算法默认配置
#   2. 本文件                             - ROS 层基础配置
#   3. 平台特定配置 (如 turtlebot1.yaml) - 平台覆盖
#   4. ROS 参数服务器                     - 运行时覆盖
#
# 本文件职责:
#   - 定义 ROS 层特有配置 (话题、TF2 参数)
#   - 提供通用的默认话题命名规范
#   - 平台特定配置应在各自的 YAML 文件中定义
#
# 注意: 算法参数 (MPC、约束、安全等) 使用 DEFAULT_CONFIG 默认值
#       无需在此重复定义
#

# =============================================================================
# 话题配置 - ROS 层特有
#
# 命名规范:
# - 输入话题: /controller/input/<name>
# - 输出话题: /controller/<name>
# - 空字符串 "" 表示禁用该话题
# =============================================================================
topics:
  # 输入话题
  odom: "/controller/input/odom"
  imu: ""                                     # 默认禁用，平台配置中启用
  trajectory: "/controller/input/trajectory"
  emergency_stop: "/controller/emergency_stop"
  
  # 输出话题
  cmd_unified: "/controller/cmd"
  diagnostics: "/controller/diagnostics"
  state: "/controller/state"
  debug_path: "/controller/debug_path"
  attitude_cmd: "/controller/attitude_cmd"    # 仅四旋翼平台

# =============================================================================
# 坐标变换配置 - ROS TF2 特有参数
#
# 算法层参数 (source_frame, target_frame, timeout_ms 等) 使用 DEFAULT_CONFIG
# 本文件只定义 ROS TF2 扩展参数
#
# TF2 注入重试策略:
# - 使用指数退避：初始间隔 -> 2x -> 4x -> ... -> 最大间隔
# - 成功注入后重置退避状态
# - max_retries = -1 表示无限重试
# =============================================================================
transform:
  buffer_warmup_timeout_sec: 2.0  # TF buffer 预热超时 (秒)
  buffer_warmup_interval_sec: 0.1 # TF buffer 预热检查间隔 (秒)
  retry_interval_sec: 1.0         # TF2 初始重试间隔 (秒)
  max_retry_interval_sec: 30.0    # TF2 最大重试间隔 (秒)
  backoff_multiplier: 2.0         # TF2 重试退避倍数
  max_retries: -1                 # TF2 最大重试次数 (-1 = 无限)

# =============================================================================
# 时钟配置 - 时钟跳变检测参数
#
# 用于检测仿真时间跳变或系统时钟异常。
# 大多数场景使用默认值即可，仅在特殊需求时修改。
# =============================================================================
clock:
  jitter_tolerance: 0.001         # 时钟抖动容忍度 (秒)，小于此值的跳变被忽略
  jump_threshold: 1.0             # 时钟大幅跳变阈值 (秒)，超过此值触发警告
  max_events: 10                  # 最多保留的时钟跳变事件数
