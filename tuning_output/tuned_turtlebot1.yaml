# =============================================================================
# 自动调优配置 - 由 auto_tune.py 生成
# 生成时间: 2026-01-01 23:33
# =============================================================================
# 
# 调优变更:
#   - watchdog.traj_timeout_ms: 1500 → 2309
#     原因: 轨迹超时率 1.3%, p99延迟 1540ms
#   - watchdog.traj_grace_ms: 900 → 1458
#     原因: 轨迹帧率 2.2Hz, 宽限期需要更长
#   - mpc.weights.heading: 8.0 → 10.4
#     原因: 航向误差 avg=25.8° 过大
#   - tracking.longitudinal_thresh: 0.6 → 0.69
#     原因: 纵向误差 p95=52.9cm 接近阈值
#   - tracking.heading_thresh: 0.5 → 0.81
#     原因: 航向误差 p95=35.9° 接近阈值
#
# =============================================================================

system:
  platform: differential
  ctrl_freq: 20
constraints:
  v_max: 0.5
  v_min: -0.2
  omega_max: 1.0
  omega_max_low: 0.5
  v_low_thresh: 0.1
  a_max: 0.5
  alpha_max: 1.5
watchdog:
  odom_timeout_ms: 500
  traj_timeout_ms: 2309
  traj_grace_ms: 1458
  imu_timeout_ms: 100
  startup_grace_ms: 5000
  absolute_startup_timeout_ms: -1
diagnostics:
  publish_rate: 5
mpc:
  horizon: 7
  horizon_degraded: 4
  dt: 0.1
  weights:
    position: 15.0
    velocity: 7.8
    heading: 10.4
    control_accel: 0.1
    control_alpha: 0.1
  health_monitor:
    time_warning_thresh_ms: 20
    time_critical_thresh_ms: 40
    time_recovery_thresh_ms: 15
    consecutive_warning_limit: 10
    consecutive_recovery_limit: 5
  fallback:
    lookahead_steps: 3
trajectory:
  low_speed_thresh: 0.05
  min_points: 2
  max_points: 100
  max_point_distance: 10.0
  default_dt_sec: 0.1
consistency:
  alpha_min: 0.1
  kappa_thresh: 0.5
  v_dir_thresh: 0.8
  temporal_smooth_thresh: 0.5
  max_curvature: 10.0
  temporal_window_size: 10
  weights:
    kappa: 0.3
    velocity: 0.3
    temporal: 0.4
tracking:
  lateral_thresh: 0.25
  longitudinal_thresh: !!python/object/apply:numpy.core.multiarray.scalar
  - &id001 !!python/object/apply:numpy.dtype
    args:
    - f8
    - false
    - true
    state: !!python/tuple
    - 3
    - <
    - null
    - null
    - null
    - -1
    - -1
    - 0
  - !!binary |
    FK5H4XoU5j8=
  heading_thresh: !!python/object/apply:numpy.core.multiarray.scalar
  - *id001
  - !!binary |
    7FG4HoXr6T8=
safety:
  emergency_decel: 1.0
  v_stop_thresh: 0.05
  stopping_timeout: 5.0
  state_machine:
    alpha_disable_thresh: 0.0
    mpc_recovery_thresh: 5
    mpc_recovery_tolerance: 1
    mpc_fail_window_size: 10
    mpc_fail_thresh: 3
backup:
  lookahead_dist: 0.5
  min_lookahead: 0.3
  max_lookahead: 1.5
  lookahead_ratio: 0.5
  kp_heading: 2.0
  heading_error_thresh: 1.047
  max_curvature: 5.0
  default_speed_ratio: 0.5
  min_distance_thresh: 0.1
transform:
  source_frame: base_footprint
  target_frame: odom
  timeout_ms: 50
cmd_vel_adapter:
  publish_rate: 20.0
  cmd_timeout: 0.5
  enable_rate_limit: true
  joy_topic: /joy_cmd_vel
  mode_topic: /visualizer/control_mode
  output_topic: /mobile_base/commands/velocity
topics:
  odom: /odom
  imu: /mobile_base/sensors/imu_data
  trajectory: /controller/input/trajectory
  cmd_unified: /cmd_unified
